import{c as i,K as C,b as w}from"./ConfigManager-f1a6a1ab.js";let m=!0,l,r;function v(){C.attachConfig(i.current),P(),[].forEach.call($$(".siteSpecificToggle"),t=>t.style.display="none"),F(),document.getElementById("i18n_root").style.display="block"}function P(){document.getElementById("pref_searchAllOpenDBs_label").checked=i.current.searchAllOpenDBs?i.current.searchAllOpenDBs:null,document.getElementById("pref_autoFillFormsWithMultipleMatches_label").checked=i.current.autoFillFormsWithMultipleMatches?i.current.autoFillFormsWithMultipleMatches:null,document.getElementById("pref_autoFillFieldsWithExistingValue_label").checked=i.current.autoFillFieldsWithExistingValue?i.current.autoFillFieldsWithExistingValue:null,document.getElementById("pref_manualFillSubmitOverridable_label").checked=i.current.manualSubmitOverrideProhibited?null:!0,document.getElementById("pref_when_one_matching_network_login").checked=i.current.autoSubmitNetworkAuthWithSingleMatch?i.current.autoSubmitNetworkAuthWithSingleMatch:null,document.getElementById("pref_saveFavicons_label").checked=i.current.saveFavicons?i.current.saveFavicons:null,document.getElementById("pref_rememberMRUGroup_label").checked=i.current.rememberMRUGroup?i.current.rememberMRUGroup:null,document.getElementById("pref_animateWhenOfferingSave_label").checked=i.current.animateWhenOfferingSave?i.current.animateWhenOfferingSave:null,document.getElementById("pref_showConfirmationAfterSave_label").checked=i.current.hideConfirmationAfterSave?null:!0,document.getElementById("pref_rememberMRUDB_label").checked=i.current.rememberMRUDB?i.current.rememberMRUDB:null,document.getElementById("pref_when_kee_chooses_standard_form_desc").value=i.current.autoSubmitForms?"FillAndSubmit":i.current.autoFillForms?"Fill":"DoNothing",document.getElementById("pref_when_user_chooses_desc").value=i.current.autoSubmitMatchedForms?"FillAndSubmit":"Fill",document.getElementById("pref_logLevel_desc").value=le(i.current.logLevel),document.getElementById("pref_theme_desc").value=ie(i.current.theme),document.getElementById("pref_currentSearchTermTimeout_label").value=i.current.currentSearchTermTimeout?i.current.currentSearchTermTimeout.toString():"",document.getElementById("pref_keePassRPCPort_label").value=i.current.KeePassRPCWebSocketPort?i.current.KeePassRPCWebSocketPort.toString():"",document.getElementById("pref_keePassDBToOpen_label").value=i.current.keePassDBToOpen,E()}function F(){document.getElementById("pref_searchAllOpenDBs_label").addEventListener("change",N),document.getElementById("pref_autoFillFormsWithMultipleMatches_label").addEventListener("change",V),document.getElementById("pref_autoFillFieldsWithExistingValue_label").addEventListener("change",U),document.getElementById("pref_manualFillSubmitOverridable_label").addEventListener("change",q),document.getElementById("pref_when_one_matching_network_login").addEventListener("change",$),document.getElementById("pref_notifyBarRequestPasswordSave_label").addEventListener("change",b),document.getElementById("requestPasswordSaveSelect").addEventListener("change",b),document.getElementById("pref_listMatchingIgnoreCase_label").addEventListener("change",k),document.getElementById("listMatchingIgnoreCaseSelect").addEventListener("change",k),document.getElementById("pref_saveFavicons_label").addEventListener("change",K),document.getElementById("pref_rememberMRUGroup_label").addEventListener("change",G),document.getElementById("pref_animateWhenOfferingSave_label").addEventListener("change",H),document.getElementById("pref_showConfirmationAfterSave_label").addEventListener("change",j),document.getElementById("pref_rememberMRUDB_label").addEventListener("change",Y),document.getElementById("pref_when_kee_chooses_standard_form_desc").addEventListener("change",z),document.getElementById("pref_when_user_chooses_desc").addEventListener("change",J),document.getElementById("pref_logLevel_desc").addEventListener("change",Q),document.getElementById("pref_currentSearchTermTimeout_label").addEventListener("change",Z),document.getElementById("pref_keePassRPCPort_label").addEventListener("change",ee),document.getElementById("pref_keePassDBToOpen_label").addEventListener("change",te),document.getElementById("siteOptionsModeAll").addEventListener("change",W),document.getElementById("siteOptionsModeSpecific").addEventListener("change",R),document.getElementById("siteChooserSearch").addEventListener("input",O),document.getElementById("siteSearchClearButton").addEventListener("click",_),document.getElementById("siteChooserForm").addEventListener("submit",t=>{t.preventDefault(),t.stopPropagation(),document.getElementById("siteChooserSearch").value.length>=2&&h()}),document.getElementById("siteAddButton").addEventListener("click",h),document.getElementById("siteEditButton").addEventListener("click",h),document.getElementById("siteDeleteButton").addEventListener("click",A),document.getElementById("sitePropertiesValue").addEventListener("change",x),document.getElementById("sitePropertiesMethodExact").addEventListener("change",p),document.getElementById("sitePropertiesMethodPrefix").addEventListener("change",p),document.getElementById("sitePropertiesMethodRegex").addEventListener("change",p),document.querySelector("#sitePropertiesModal .modal-header button.close").addEventListener("click",y),document.getElementById("sitePropertiesCancel").addEventListener("click",y),document.getElementById("sitePropertiesSave").addEventListener("click",M);for(const t of $$(".formFindingControlGroup"))t.firstElementChild.firstElementChild.addEventListener("change",D),t.firstElementChild.nextElementSibling.addEventListener("change",B);document.getElementById("pref_theme_desc").addEventListener("change",X)}function A(){if(l){const t=i.siteConfigLookupFor(l.target,l.method);t&&delete t[l.value],i.save(),_()}}function h(){const t=document.getElementById("sitePropertiesValue");t.value=document.getElementById("siteChooserSearch").value,g();let n=Array.from(document.querySelectorAll("#sitePropertiesTarget input"));const s=l?l.target:"Host";n.forEach(a=>{a.value===s?a.checked=!0:a.checked=null}),n=Array.from(document.querySelectorAll("#sitePropertiesMethod input"));const e=l?l.method:"Exact";n.forEach(a=>{a.value===e?a.checked=!0:a.checked=null}),document.getElementById("sitePropertiesWeight").value=l?l.matchWeight.toString():"100";const o=document.getElementById("sitePropertiesModal");o.style.display="block",o.style.opacity="1"}function y(){const t=document.getElementById("sitePropertiesModal");t.style.opacity="0",t.style.display="none"}function M(){if(g()){const t=document.getElementById("sitePropertiesValue").value,n=parseInt(document.getElementById("sitePropertiesWeight").value);let s=Array.from(document.querySelectorAll("#sitePropertiesTarget input"));const e=s.find(d=>d.checked).value;s=Array.from(document.querySelectorAll("#sitePropertiesMethod input"));const o=s.find(d=>d.checked).value;let a={};if(l){a=l.config;const d=i.siteConfigLookupFor(l.target,l.method);d&&delete d[l.value]}l={value:t,matchWeight:n,source:"User",target:e,method:o,config:a};const f=i.siteConfigLookupFor(e,o);f[t]={config:a,source:"User",matchWeight:n},i.save(),y(),S()}}function x(){g()}function p(){g()}function g(){let t=!0;const n=document.getElementById("sitePropertiesSave"),s=document.getElementById("sitePropertiesValueValidation");if(document.getElementById("sitePropertiesMethodRegex").checked)try{new RegExp(document.getElementById("sitePropertiesValue").value)}catch{t=!1}return t?(n.disabled=null,s.innerText="",s.style.display="none"):(n.disabled=!0,s.innerText=$STR("enter_valid_regex"),s.style.display="block"),t}function D(t){const n=t.target,s=n.parentElement.nextElementSibling;if(s.disabled=!n.checked,n.checked)return B(null,s);let e;switch(m?e=i.current.siteConfig.pageRegex["^.*$"].config:e=i.siteConfigLookupFor(l.target,l.method)[l.value].config,s.id){case"sssWhiteFormName":e.whiteList&&e.whiteList.form&&e.whiteList.form.names&&(delete e.whiteList.form.names,e.whiteList.form.ids||(delete e.whiteList.form,!e.whiteList.fields&&!e.whiteList.querySelectors&&delete e.whiteList));break;case"sssWhiteFormId":e.whiteList&&e.whiteList.form&&e.whiteList.form.ids&&(delete e.whiteList.form.ids,e.whiteList.form.names||(delete e.whiteList.form,!e.whiteList.fields&&!e.whiteList.querySelectors&&delete e.whiteList));break;case"sssWhiteFieldName":e.whiteList&&e.whiteList.fields&&e.whiteList.fields.names&&(delete e.whiteList.fields.names,e.whiteList.fields.ids||(delete e.whiteList.fields,!e.whiteList.fields&&!e.whiteList.querySelectors&&delete e.whiteList));break;case"sssWhiteFieldId":e.whiteList&&e.whiteList.fields&&e.whiteList.fields.ids&&(delete e.whiteList.fields.ids,e.whiteList.fields.names||(delete e.whiteList.fields,!e.whiteList.fields&&!e.whiteList.querySelectors&&delete e.whiteList));break;case"sssBlackFormName":e.blackList&&e.blackList.form&&e.blackList.form.names&&(delete e.blackList.form.names,e.blackList.form.ids||(delete e.blackList.form,!e.blackList.fields&&!e.blackList.querySelectors&&delete e.blackList));break;case"sssBlackFormId":e.blackList&&e.blackList.form&&e.blackList.form.ids&&(delete e.blackList.form.ids,e.blackList.form.names||(delete e.blackList.form,!e.blackList.fields&&!e.blackList.querySelectors&&delete e.blackList));break;case"sssBlackFieldName":e.blackList&&e.blackList.fields&&e.blackList.fields.names&&(delete e.blackList.fields.names,e.blackList.fields.ids||(delete e.blackList.fields,!e.blackList.fields&&!e.blackList.querySelectors&&delete e.blackList));break;case"sssBlackFieldId":e.blackList&&e.blackList.fields&&e.blackList.fields.ids&&(delete e.blackList.fields.ids,e.blackList.fields.names||(delete e.blackList.fields,!e.blackList.fields&&!e.blackList.querySelectors&&delete e.blackList));break}i.save()}function B(t,n){n||(n=t.target);const s=n.value?n.value.split(","):[];let e;if(m)e=i.current.siteConfig.pageRegex["^.*$"].config;else{const o=i.siteConfigLookupFor(l.target,l.method);e=o[l.value].config,o[l.value].source="User"}switch(n.id){case"sssWhiteFormName":e.whiteList||(e.whiteList={}),e.whiteList.form||(e.whiteList.form={}),e.whiteList.form.names=s.filter(o=>o.length>0);break;case"sssWhiteFormId":e.whiteList||(e.whiteList={}),e.whiteList.form||(e.whiteList.form={}),e.whiteList.form.ids=s.filter(o=>o.length>0);break;case"sssWhiteFieldName":e.whiteList||(e.whiteList={}),e.whiteList.fields||(e.whiteList.fields={}),e.whiteList.fields.names=s.filter(o=>o.length>0);break;case"sssWhiteFieldId":e.whiteList||(e.whiteList={}),e.whiteList.fields||(e.whiteList.fields={}),e.whiteList.fields.ids=s.filter(o=>o.length>0);break;case"sssBlackFormName":e.blackList||(e.blackList={}),e.blackList.form||(e.blackList.form={}),e.blackList.form.names=s.filter(o=>o.length>0);break;case"sssBlackFormId":e.blackList||(e.blackList={}),e.blackList.form||(e.blackList.form={}),e.blackList.form.ids=s.filter(o=>o.length>0);break;case"sssBlackFieldName":e.blackList||(e.blackList={}),e.blackList.fields||(e.blackList.fields={}),e.blackList.fields.names=s.filter(o=>o.length>0);break;case"sssBlackFieldId":e.blackList||(e.blackList={}),e.blackList.fields||(e.blackList.fields={}),e.blackList.fields.ids=s.filter(o=>o.length>0);break}i.save()}function u(t,n,s){const e=document.getElementById(t),o=e.parentElement.firstElementChild.firstElementChild;e.value=s.join(),e.disabled=n?null:!0,o.checked=n?!0:null}function E(){const t=m?i.current.siteConfig.pageRegex["^.*$"].config:l.config;if(m)document.getElementById("pref_notifyBarRequestPasswordSave_label").checked=t.preventSaveNotification===!0?null:!0,document.getElementById("pref_listMatchingIgnoreCase_label").checked=t.listMatchingCaseSensitive===!0?null:!0;else{const s=t.preventSaveNotification===!0?"No":t.preventSaveNotification===!1?"Yes":"Inherit";document.getElementById("requestPasswordSaveSelect").value=s;const e=t.listMatchingCaseSensitive===!0?"No":t.listMatchingCaseSensitive===!1?"Yes":"Inherit";document.getElementById("listMatchingIgnoreCaseSelect").value=e}let n;n=!!(t.whiteList&&t.whiteList.form&&t.whiteList.form.names),u("sssWhiteFormName",n,n?t.whiteList.form.names:[]),n=!!(t.whiteList&&t.whiteList.form&&t.whiteList.form.ids),u("sssWhiteFormId",n,n?t.whiteList.form.ids:[]),n=!!(t.whiteList&&t.whiteList.fields&&t.whiteList.fields.names),u("sssWhiteFieldName",n,n?t.whiteList.fields.names:[]),n=!!(t.whiteList&&t.whiteList.fields&&t.whiteList.fields.ids),u("sssWhiteFieldId",n,n?t.whiteList.fields.ids:[]),n=!!(t.blackList&&t.blackList.form&&t.blackList.form.names),u("sssBlackFormName",n,n?t.blackList.form.names:[]),n=!!(t.blackList&&t.blackList.form&&t.blackList.form.ids),u("sssBlackFormId",n,n?t.blackList.form.ids:[]),n=!!(t.blackList&&t.blackList.fields&&t.blackList.fields.names),u("sssBlackFieldName",n,n?t.blackList.fields.names:[]),n=!!(t.blackList&&t.blackList.fields&&t.blackList.fields.ids),u("sssBlackFieldId",n,n?t.blackList.fields.ids:[])}function W(t){t.preventDefault(),t.target.checked&&(m=!0,l=null,document.getElementById("siteChooser").style.display="none",document.getElementById("siteList").style.display="none",document.getElementById("siteAddButton").style.display="none",document.getElementById("siteEditButton").style.display="none",document.getElementById("siteDeleteButton").style.display="none",document.getElementById("hiddenOptionsPresent").style.display="none",document.getElementById("siteSearchClearButton").style.display="none",document.getElementById("settings").style.display="block",document.getElementById("panelFindingEntries").style.display="block",document.getElementById("panelFillingEntries").style.display="block",document.getElementById("panelNetworkAuthentication").style.display="block",document.getElementById("panelLogging").style.display="block",document.getElementById("panelAppearance").style.display="block",document.getElementById("panelAdvanced").style.display="block",[].forEach.call($$(".siteSpecificToggle"),n=>n.style.display="none"),[].forEach.call($$(".nonSiteSpecificField"),n=>n.style.display=null),document.getElementById("siteChooserSearch").value="",E())}function R(t){t.preventDefault(),t.target.checked&&(m=!1,document.getElementById("siteChooser").style.display="block",document.getElementById("settings").style.display="none",document.getElementById("panelFindingEntries").style.display="none",document.getElementById("panelFillingEntries").style.display="none",document.getElementById("panelNetworkAuthentication").style.display="none",document.getElementById("panelLogging").style.display="none",document.getElementById("panelAppearance").style.display="none",document.getElementById("panelAdvanced").style.display="none",[].forEach.call($$(".siteSpecificToggle"),n=>n.style.display=null),[].forEach.call($$(".nonSiteSpecificField"),n=>n.style.display="none"),L(""),document.getElementById("siteChooserSearch").focus())}function O(){const t=document.getElementById("siteChooserSearch").value;if(document.getElementById("settings").style.display="none",document.getElementById("siteList").style.display="none",document.getElementById("siteAddButton").style.display="none",document.getElementById("siteEditButton").style.display="none",document.getElementById("siteDeleteButton").style.display="none",l=null,t.length<1){document.getElementById("siteSearchClearButton").style.display="none";return}else document.getElementById("siteSearchClearButton").style.display="block";if(L(t),r.length==0){document.getElementById("siteAddButton").style.display="block";return}else if(r.length==1&&r[0].value==t){I(0);return}}function I(t){l=r[t],S()}function S(){document.getElementById("siteAddButton").style.display="none",document.getElementById("siteList").style.display="none",document.getElementById("siteEditButton").style.display=l.source==="Auto"?"none":"block",document.getElementById("siteDeleteButton").style.display=l.source==="Auto"?"none":"block",document.getElementById("hiddenOptionsPresent").style.display=l.source==="Auto"?"block":"none",document.getElementById("siteSearchClearButton").style.display="block",document.getElementById("siteChooserSearch").value=l.value,document.getElementById("settings").style.display="block",E()}function _(){document.getElementById("siteChooserSearch").value="",document.getElementById("siteSearchClearButton").style.display="none",document.getElementById("siteAddButton").style.display="none",document.getElementById("siteEditButton").style.display="none",document.getElementById("siteDeleteButton").style.display="none",document.getElementById("hiddenOptionsPresent").style.display="none",document.getElementById("settings").style.display="none",document.getElementById("siteChooserSearch").focus(),L("")}function L(t){r=T(t),document.querySelector("#siteListResults > tbody").textContent="";for(const n in r){const s=document.createElement("tr"),e=document.createElement("a");e.href="#",e.innerText=r[n].value;const o=document.createElement("td");o.addEventListener("click",()=>I(n)),o.appendChild(e),s.appendChild(o);const a=document.createElement("td");a.innerText=r[n].target,s.appendChild(a);const f=document.createElement("td");f.innerText=r[n].method,s.appendChild(f);const d=document.createElement("td");d.innerText=r[n].matchWeight.toString(),s.appendChild(d),document.querySelector("#siteListResults > tbody").appendChild(s)}return document.getElementById("siteList").style.display="block",r}function T(t){const n=[];return i.current.siteConfig.domainExact&&c(t,n,i.current.siteConfig.domainExact,"Domain","Exact"),i.current.siteConfig.domainPrefix&&c(t,n,i.current.siteConfig.domainPrefix,"Domain","Prefix"),i.current.siteConfig.domainRegex&&c(t,n,i.current.siteConfig.domainRegex,"Domain","Regex"),i.current.siteConfig.hostExact&&c(t,n,i.current.siteConfig.hostExact,"Host","Exact"),i.current.siteConfig.hostPrefix&&c(t,n,i.current.siteConfig.hostPrefix,"Host","Prefix"),i.current.siteConfig.hostRegex&&c(t,n,i.current.siteConfig.hostRegex,"Host","Regex"),i.current.siteConfig.pageExact&&c(t,n,i.current.siteConfig.pageExact,"Page","Exact"),i.current.siteConfig.pagePrefix&&c(t,n,i.current.siteConfig.pagePrefix,"Page","Prefix"),i.current.siteConfig.pageRegex&&c(t,n,i.current.siteConfig.pageRegex,"Page","Regex"),n.sort((s,e)=>s.value.localeCompare(e.value))}function c(t,n,s,e,o){for(const a in s)a!=="^.*$"&&a.startsWith(t)&&n.push(Object.assign({value:a,target:e,method:o},s[a]))}function N(t){t.preventDefault(),i.setASAP({searchAllOpenDBs:document.getElementById("pref_searchAllOpenDBs_label").checked})}function V(t){t.preventDefault(),i.setASAP({autoFillFormsWithMultipleMatches:document.getElementById("pref_autoFillFormsWithMultipleMatches_label").checked})}function U(t){t.preventDefault(),i.setASAP({autoFillFieldsWithExistingValue:document.getElementById("pref_autoFillFieldsWithExistingValue_label").checked})}function q(t){t.preventDefault(),i.setASAP({manualSubmitOverrideProhibited:!document.getElementById("pref_manualFillSubmitOverridable_label").checked})}function $(t){t.preventDefault(),i.setASAP({autoSubmitNetworkAuthWithSingleMatch:document.getElementById("pref_when_one_matching_network_login").checked})}function b(t){if(t.preventDefault(),m){const n=document.getElementById("pref_notifyBarRequestPasswordSave_label").checked;i.current.siteConfig.pageRegex["^.*$"].config.preventSaveNotification=!n}else{const n=document.getElementById("requestPasswordSaveSelect").value,s=n==="Inherit"?null:n=="No",e=i.siteConfigLookupFor(l.target,l.method);e[l.value].config.preventSaveNotification=s,e[l.value].source="User"}i.save()}function k(t){if(t.preventDefault(),m){const n=document.getElementById("pref_listMatchingIgnoreCase_label").checked;i.current.siteConfig.pageRegex["^.*$"].config.listMatchingCaseSensitive=!n}else{const n=document.getElementById("listMatchingIgnoreCaseSelect").value,s=n==="Inherit"?null:n=="No",e=i.siteConfigLookupFor(l.target,l.method);e[l.value].config.listMatchingCaseSensitive=s,e[l.value].source="User"}i.save()}function K(t){t.preventDefault(),i.setASAP({saveFavicons:document.getElementById("pref_saveFavicons_label").checked})}function G(t){t.preventDefault(),i.setASAP({rememberMRUGroup:document.getElementById("pref_rememberMRUGroup_label").checked})}function H(t){t.preventDefault(),i.setASAP({animateWhenOfferingSave:document.getElementById("pref_animateWhenOfferingSave_label").checked})}function j(t){t.preventDefault(),i.setASAP({hideConfirmationAfterSave:!document.getElementById("pref_showConfirmationAfterSave_label").checked})}function Y(t){t.preventDefault(),i.setASAP({rememberMRUDB:document.getElementById("pref_rememberMRUDB_label").checked})}function z(t){t.preventDefault();const n=document.getElementById("pref_when_kee_chooses_standard_form_desc").value;i.setASAP({autoFillForms:n!="DoNothing"}),i.setASAP({autoSubmitForms:n=="FillAndSubmit"})}function J(t){t.preventDefault();const n=document.getElementById("pref_when_user_chooses_desc").value;i.setASAP({autoSubmitMatchedForms:n=="FillAndSubmit"})}function Q(t){t.preventDefault();const n=document.getElementById("pref_logLevel_desc").value;i.setASAP({logLevel:se(n)})}function X(t){t.preventDefault();const n=document.getElementById("pref_theme_desc").value;i.setASAP({theme:ne(n)})}function Z(t){t.preventDefault(),i.setASAP({currentSearchTermTimeout:parseInt(document.getElementById("pref_currentSearchTermTimeout_label").value)})}function ee(t){t.preventDefault(),i.current.KeePassRPCWebSocketPort=parseInt(document.getElementById("pref_keePassRPCPort_label").value),i.save().then(()=>w.runtime.sendMessage({action:"KPRPC_Port_Change"}))}function te(t){t.preventDefault(),i.setASAP({keePassDBToOpen:document.getElementById("pref_keePassDBToOpen_label").value})}function ne(t){return t||null}function ie(t){return t||""}function se(t){switch(t){case"Debugging":return 4;case"Information":return 3;case"Warnings":return 2;case"Errors":return 1;default:return 0}}function le(t){switch(t){case 4:return"Debugging";case 3:return"Information";case 2:return"Warnings";case 1:return"Errors";default:return"Internal error - report to Kee team"}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>i.load(v)):i.load(v);
